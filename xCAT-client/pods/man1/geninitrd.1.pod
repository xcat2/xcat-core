=head1 NAME

B<geninitrd> - Regenerates the initrd for a stateless image to be used for a diskless install.

=head1 SYNOPSIS

B<geninitrd> [B<-i> I<nodebootif>] [B<-n> I<nodenetdrivers>] [B<-o> I<OS>] [B<-p>] [I<profile>] [B<-l> I<rootlimit>] [B<-k> I<kernel_version>] [B<--permission> I<permission>]

B<geninitrd> [B<-i> I<nodebootif>] [B<-n> I<nodenetdrivers>] [B<-o> I<OS>] [B<-p>] [I<profile>] [B<-l> I<rootlimit>] [B<-k> I<kernel_version>] [B<--permission> I<permission>] imagename

B<geninitrd> [B<-h> | B<--help> | B<-v> | B<--version>]


=head1 DESCRIPTION

Regenerates the initrd that is part of a stateless/statelite image that is used to boot xCAT nodes in a stateless/statelite mode.
The generated initrd will be put in /install/netboot/<OS>/<arch>/<profile>.

The B<geninitrd> command must be run on a system that is the same architecture as the nodes it will be
used on.  If the management node is not the same architecture, copy the contents of
/opt/xcat/share/xcat/netboot/<OS> to a system that is the proper architecture, and mount /install from
the management node to that system.

The B<geninitrd> command will generate two initial ramdisks, one is B<initrd-statelite.gz> for B<statelite> mode, the other one is B<initrd-stateless.gz> for B<stateless> mode.


=head1 OPTIONS

=over 12

=item B<-o> I<OS>

The operating system for the image:  fedora8, rhel5, sles10, etc.  The OS packages must be in
/install/<OS>/<arch> (use L<copycds(8)|copycds.8>).

=item B<-p> I<profile>

The profile (e.g. compute, service) to use to create the image.  This determines what package lists are
used from /opt/xcat/share/xcat/netboot/<OS> to create the image with.  When deploying nodes with this image,
the nodes' nodetype.profile attribute must be set to this same value.

=item B<-i> I<nodebootif>

The network interface the diskless node will boot over (e.g. eth0).

=item B<-n> I<nodenetdrivers>

The driver modules needed for the network interface.  Note:  the order that the drivers are specified in
is important.

=item B<-l> I<rootlimit>

The maximum size allowed for the root file system in the image.  Specify in bytes, or can append k, m, or g.

=item B<-k> I<kernel_version>

Use this flag if you want to use a specific version of the kernel in the image.  Defaults to the first kernel found
in the install image.

=item B<-v>

Display version.

=item B<-h>

Display usage message.

=back


=head1 RETURN VALUE

0 The command completed successfully.

1 An error has occurred.


=head1 EXAMPLES

=over 3

=item 1.

To regenerate the initrd for a fedora8 image for a compute node architecture x86_64 and place it in the
/install/netboot/fedora8/x86_64/compute/rootimg directory:  change directory to
/opt/xcat/share/xcat/netboot/fedora and run:

 geninitrd -i eth0 -n tg3,bnx2 -o fedora8 -p compute

=back


=head1 FILES

/opt/xcat/share/xcat/netboot/<OS>/geninitrd


=head1 SEE ALSO

L<genimage(1)|genimage.1>, L<packimage(1)|packimage.1>
